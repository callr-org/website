<%@string script="rfile"%>
<%@include file="incl/header.R.rsp"%>
local({
<%@include file="incl/utils.R.rsp"%>
<%@include file="incl/findPackages.R"%>
pkgs <- findPackages()

if (nrow(pkgs) == 0L) {
  # Display usage
  msg <- "R/Bioconductor package installer v1.0.2 by Henrik Bengtsson"
  msg <- c(msg, "")
  msg <- c(msg, "Usage:")
  msg <- c(msg, "  source('<%=url%>#<package>')")
  msg <- c(msg, "")
  msg <- c(msg, "Example:")
  msg <- c(msg, "  source('<%=url%>#aroma.light')")
  message(paste(msg, collapse="\n"))
} else {
  # Install package
  if (nrow(pkgs) == 1L) {
    msg <- "Installing/updating Bioconductor package:"
  } else {
    msg <- "Installing/updating Bioconductor packages:"
  }
  message(msg, " ", paste(sQuote(pkgs$name), collapse=", "))
  source("http://bioconductor.org/biocLite.R", local=FALSE)
  biocLite(pkgs$name)
}

withVerbose({
  mprint(sessionInfo())
  mprintf("pkgType=%s\n", sQuote(getOption("pkgType")))
})
}) # local()
